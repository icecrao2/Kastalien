앱 프로세스의 생명주기는 앱이 아니라 OS가 관리한다.

OS는 메모리 상황과 사용자와의 관련도를 기준으로 프로세스를 사려둘수도 있고 언제든 종료할 수도 있다.

그래서 개발자는 앱 프로세스가 중요한 작업을 실행중에 있을때 OS가 이 프로세스를 종료하지 못하도록 잘 처리해줘야 한다.

대표적인 버그로 BroadCastReciever를 들었는데 이것이 무슨 역할인지 모르니 그냥 외우고 일단 패스하겠다.

## Process 중요도 개층

1. Foreground 프로세스
    1. 최상단에서 사용중인 프로세스 (onResume)
    2. 실행중인 BroadcastReceiver.onReceive()가 있을때
    3. 현재 콜백 중 하나에서 코드를 실행중인 Service가 있는 경우(Service.onCreate, .onStart, .onDestroy)
2. visible 프로세스
    1. 화면에는 보이지만 포커싱 되어있지 않은 프로세스 (onPause)
    2. Service.startForeground()를 통해 포어그라운드 서비스로 실행중인 서비스가 있는 경우
3. service 프로세스
    1. 사용자가 보지 못하지만 의미있는 백그라운드 작업을 수행중인 프로세스
        1. startService로 실행중인 서비스를 가지고 있는 프로세스
            1. 단, service를 너무 오래 구동시키면(예: 30분) cached 영역으로 밀려나 중요도 레벨이 떨어지게 됨 ⇒ 이를 위해서 setForeground, alarmManager 등을 통해 이 서비스는 오래 구동될 서비스라는 것을 명시해둬야함
4. cache 프로세스
    1. 사실상 이미 죽은 프로세스들(onStop) → BackStack 하단으로 밀려난 상황도 포함됨
    2. 정상적인 시스템은 cache 프로세스를 유지하고 필요에 따라 부분적으로 삭제함
        1. 만약, cache 프로세스가 모두 Kill당했다면(service process kill 시작 뭔가 문제가 있다고 봐야함
    3. 캐시된 프로세스는 언제든지 삭제될 수 있기 때문에 캐시된 프로세스에 있는 리소스들을 미리 정리해둬야함

## +Alpha

- process 삭제 제어를 앱단에서 할 수 없으니 언제 어떤 앱이 삭제될지 알 수 없다.
    - 그러므로, 메모리 관리를 잘 하여 비정상적인 상황에서 cache process 외에 다른 프로세스 계층까지 영향이 가지 않게 해야한다.
    - 하지만, Process라는것은 우리의 앱만 있는것이 아니라 다른 앱도 포함된다. 즉, 다른 앱에서 memory를 마구잡이로 가져다 사용하면 모든 앱들에 영향을 줄 수 있다는 말이다.
        - Activity 내부에서 진행중이던 중요한 데이터가 날아가면 안되는 경우에 혹시 모를 process killed 상황에 대비하기 위하여 상황과 필요에 맞게 Bundle 또는 로컬저장소 같은곳에 잘 저장해 두는것도 좋아 보인다.(물론 많은 상황이 아니기 때문에 대부분의 경우는 오버엔지니어링일것이고 그러므로 정말 필요한 경우에는 이러한 목적의 조치가 필요해 보인다)
- 문서에 언급된 내용에 따르면 onStop된 Activity도 cached Process로 처리된다. 라고 나와있는데 여기서 의문점은 하나의 프로세스는 하나의 Activity만을 가지지 않는다는 점이다. 보통 앱에는 여러개의 Task가 존재하고 Task 내부에는 여러 Activity가 존재한다. 그리고 프로세스는 보통 앱 자체를 의미한다. 사용자가 멀티 프로세스 앱을 설정하지 않는한 보통은 하나의 앱이 하나의 프로세스이다. 그렇다면, 우리는 문서에서 언급된 내용을 조금 더 자세히 해석할 수 있게 된다. 문서에서 말하는것은 Activity를 지칭한것이 아니라 Application 프로세스의 모든 Task들의 BackStack들 중에서 가장 상단 스택에 위치한 Activity중에서 가장 높은 등급을 가지고 있는 Activity의 상태가 Foreground냐 Visible이냐 Service이냐 아니면 Cached이냐에 따라서 해당 앱의 process 중요도 점수가 매겨진다고 생각하면 될 듯 하다.
